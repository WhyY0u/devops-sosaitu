import{a as _,r as i,j as t}from"./index-C6-jK34F.js";import{M as J}from"./index-CI3jpZke.js";const K="_main_container_1fu5j_1",O="_text_one_1fu5j_7",V="_text_two_1fu5j_14",W="_filters_container_1fu5j_21",X="_search_box_1fu5j_29",Y="_search_input_1fu5j_33",Z="_filters_1fu5j_21",tt="_filter_select_1fu5j_55",et="_tickets_container_1fu5j_78",st="_tickets_grid_1fu5j_85",at="_ticket_card_1fu5j_91",it="_Expectation_1fu5j_106",nt="_InProgress_1fu5j_110",ct="_Completed_1fu5j_114",ot="_ticket_header_1fu5j_118",_t="_ticket_id_1fu5j_125",lt="_status_badge_1fu5j_131",rt="_ticket_title_1fu5j_153",ut="_ticket_description_1fu5j_160",dt="_ticket_footer_1fu5j_167",mt="_ticket_type_1fu5j_175",pt="_ticket_date_1fu5j_181",gt="_empty_state_1fu5j_186",jt="_modal_overlay_1fu5j_194",ft="_modal_content_1fu5j_208",ht="_modal_header_1fu5j_218",xt="_modal_title_1fu5j_228",kt="_modal_description_1fu5j_235",yt="_close_button_1fu5j_241",vt="_ai_summary_1fu5j_263",bt="_ai_summary_title_1fu5j_271",Nt="_modal_body_1fu5j_286",St="_ticket_info_1fu5j_290",wt="_info_title_1fu5j_294",Ct="_info_text_1fu5j_301",Tt="_responses_1fu5j_312",At="_response_form_1fu5j_331",It="_response_textarea_1fu5j_338",Rt="_status_selector_1fu5j_356",Lt="_ai_suggestions_block_1fu5j_361",Pt="_ai_suggestions_button_1fu5j_365",Et="_ai_suggestions_list_1fu5j_393",$t="_ai_suggestions_title_1fu5j_400",Dt="_ai_suggestion_item_1fu5j_407",Ft="_suggestion_number_1fu5j_425",Mt="_suggestion_text_1fu5j_433",Ut="_status_label_1fu5j_441",Bt="_status_select_1fu5j_356",Qt="_modal_actions_1fu5j_466",qt="_cancel_button_1fu5j_474",zt="_submit_button_1fu5j_492",e={main_container:K,text_one:O,text_two:V,filters_container:W,search_box:X,search_input:Y,filters:Z,filter_select:tt,tickets_container:et,tickets_grid:st,ticket_card:at,Expectation:it,InProgress:nt,Completed:ct,ticket_header:ot,ticket_id:_t,status_badge:lt,ticket_title:rt,ticket_description:ut,ticket_footer:dt,ticket_type:mt,ticket_date:pt,empty_state:gt,modal_overlay:jt,modal_content:ft,modal_header:ht,modal_title:xt,modal_description:kt,close_button:yt,ai_summary:vt,ai_summary_title:bt,modal_body:Nt,ticket_info:St,info_title:wt,info_text:Ct,responses:Tt,response_form:At,response_textarea:It,status_selector:Rt,ai_suggestions_block:Lt,ai_suggestions_button:Pt,ai_suggestions_list:Et,ai_suggestions_title:$t,ai_suggestion_item:Dt,suggestion_number:Ft,suggestion_text:Mt,status_label:Ut,status_select:Bt,modal_actions:Qt,cancel_button:qt,submit_button:zt};class Gt{async getAnalytics(){return(await _.get("/support/analytics")).data}async getTickets(c,o,g){const l=new URLSearchParams;return c&&l.append("status",c),o&&l.append("type",o),g&&l.append("search",g),(await _.get(`/support/tickets?${l.toString()}`)).data}async getTicketTypes(){return(await _.get("/support/ticket-types")).data}async getAiSuggestions(c){return(await _.post(`/support/ticket/${c}/ai-suggestions`)).data}async addResponse(c,o){return(await _.post(`/support/ticket/${c}/response`,o)).data}async updateStatus(c,o){return(await _.put(`/support/ticket/${c}/status`,o)).data}async getAiSummary(c){return(await _.get(`/support/ticket/${c}/ai-summary`)).data}}const Kt=()=>{const[P,c]=i.useState("tickets"),[o,g]=i.useState([]),[l,v]=i.useState(!0),[n,E]=i.useState(null),[f,j]=i.useState(""),[b,N]=i.useState(""),[S,h]=i.useState([]),[w,x]=i.useState(!1),[u,$]=i.useState("–í—Å–µ"),[d,D]=i.useState("–í—Å–µ"),[r,F]=i.useState(""),[C,M]=i.useState("date"),[U,m]=i.useState(!1),[T,A]=i.useState("InProgress"),[B,I]=i.useState([]),p=new Gt;i.useEffect(()=>{Q(),R()},[u,d,r]);const Q=async()=>{try{const s=await p.getTicketTypes();I(s)}catch(s){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–∏–ø–æ–≤:",s),I([])}},R=async()=>{v(!0);try{let a=(await p.getTickets(u,d,r)).items;C==="date"?a.sort((k,y)=>new Date(y.ticket.createdTime).getTime()-new Date(k.ticket.createdTime).getTime()):a.sort((k,y)=>k.ticket.status.localeCompare(y.ticket.status)),g(a)}catch(s){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–∏–∫–µ—Ç–æ–≤:",s)}finally{v(!1)}},q=async s=>{E(s),m(!0),j(""),A("InProgress"),h([]),x(!1);try{const a=await p.getAiSummary(s.ticket.id);N(a)}catch{N("")}},z=async()=>{if(n){x(!0);try{const s=await p.getAiSuggestions(n.ticket.id);h(s)}catch(s){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ AI-–∑–∞–≥–æ—Ç–æ–≤–æ–∫:",s),h([]),alert("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å AI-–∑–∞–≥–æ—Ç–æ–≤–∫–∏")}finally{x(!1)}}},G=s=>{j(s)},H=async()=>{if(!n||!f.trim()){alert("–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞");return}try{await p.addResponse(n.ticket.id,{response:f,status:T}),m(!1),j(""),R(),alert("–û—Ç–≤–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω")}catch(s){alert(s.response?.data||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –æ—Ç–≤–µ—Ç–∞")}},L=o.filter(s=>{const a=s.ticket;return!(u!=="–í—Å–µ"&&a.status!==u||d!=="–í—Å–µ"&&a.type!==d||r&&!a.name.toLowerCase().includes(r.toLowerCase())&&!a.description.toLowerCase().includes(r.toLowerCase()))});return l?t.jsx("div",{className:e.main_container,children:"–ó–∞–≥—Ä—É–∑–∫–∞..."}):t.jsxs("div",{className:e.main_container,children:[t.jsx("p",{className:e.text_one,children:"üéß –ü–∞–Ω–µ–ª—å Support"}),t.jsx("p",{className:e.text_two,children:"–û—Ç–≤–µ—á–∞–π—Ç–µ –Ω–∞ —Ç–∏–∫–µ—Ç—ã –∏ —É–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å–∞–º–∏"}),t.jsxs("div",{className:e.filters_container,children:[t.jsx("div",{className:e.search_box,children:t.jsx("input",{type:"text",className:e.search_input,placeholder:"üîç –ü–æ–∏—Å–∫ –ø–æ —Ç–∏–∫–µ—Ç–∞–º...",value:r,onChange:s=>F(s.target.value)})}),t.jsxs("div",{className:e.filters,children:[t.jsxs("select",{className:e.filter_select,value:u,onChange:s=>$(s.target.value),children:[t.jsx("option",{value:"–í—Å–µ",children:"–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã"}),t.jsx("option",{value:"Expectation",children:"–û–∂–∏–¥–∞–Ω–∏–µ"}),t.jsx("option",{value:"InProgress",children:"–í —Ä–∞–±–æ—Ç–µ"}),t.jsx("option",{value:"Completed",children:"–ó–∞–≤–µ—Ä—à–µ–Ω–æ"})]}),t.jsxs("select",{className:e.filter_select,value:d,onChange:s=>D(s.target.value),children:[t.jsx("option",{value:"–í—Å–µ",children:"–í—Å–µ —Ç–∏–ø—ã"}),B.map(s=>t.jsx("option",{value:s.code,children:s.title},s.code))]}),t.jsxs("select",{className:e.filter_select,value:C,onChange:s=>M(s.target.value),children:[t.jsx("option",{value:"date",children:"–ü–æ –¥–∞—Ç–µ"}),t.jsx("option",{value:"status",children:"–ü–æ —Å—Ç–∞—Ç—É—Å—É"})]})]})]}),t.jsx("div",{className:e.tickets_container,children:L.length===0?t.jsx("div",{className:e.empty_state,children:t.jsx("p",{children:"–¢–∏–∫–µ—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"})}):t.jsx("div",{className:e.tickets_grid,children:L.map(s=>{const a=s.ticket;return t.jsxs("div",{className:`${e.ticket_card} ${e[a.status]}`,onClick:()=>q(s),children:[t.jsxs("div",{className:e.ticket_header,children:[t.jsxs("span",{className:e.ticket_id,children:["#",a.id]}),t.jsxs("span",{className:`${e.status_badge} ${e[a.status]}`,children:[a.status==="Expectation"&&"üî¥ –û–∂–∏–¥–∞–Ω–∏–µ",a.status==="InProgress"&&"üü° –í —Ä–∞–±–æ—Ç–µ",a.status==="Completed"&&"üü¢ –ó–∞–≤–µ—Ä—à–µ–Ω–æ"]})]}),t.jsx("h3",{className:e.ticket_title,children:a.name}),t.jsxs("p",{className:e.ticket_description,children:[a.description.substring(0,100),"..."]}),t.jsxs("div",{className:e.ticket_footer,children:[t.jsxs("span",{className:e.ticket_type,children:["üìã ",a.type]}),t.jsx("span",{className:e.ticket_date,children:new Date(a.createdTime).toLocaleDateString("ru-RU")})]})]},a.id)})})}),U&&n&&t.jsx("div",{className:e.modal_overlay,onClick:()=>m(!1),children:t.jsxs("div",{className:e.modal_content,onClick:s=>s.stopPropagation(),children:[t.jsxs("div",{className:e.modal_header,children:[t.jsxs("div",{children:[t.jsxs("h2",{className:e.modal_title,children:["#",n.ticket.id," - ",n.ticket.name]}),t.jsxs("p",{className:e.modal_description,children:["üìã ",n.ticket.type," | üìÖ ",new Date(n.ticket.createdTime).toLocaleString("ru-RU")]})]}),t.jsx("button",{className:e.close_button,onClick:()=>m(!1),children:"‚úï"})]}),b&&t.jsxs("div",{className:e.ai_summary,children:[t.jsx("h4",{className:e.ai_summary_title,children:"ü§ñ AI-–∫—Ä–∞—Ç–∫–æ:"}),t.jsx("p",{children:b})]}),t.jsxs("div",{className:e.modal_body,children:[t.jsxs("div",{className:e.ticket_info,children:[t.jsx("h4",{className:e.info_title,children:"üìù –û–ø–∏—Å–∞–Ω–∏–µ:"}),t.jsx("p",{className:e.info_text,children:n.ticket.description}),n.ticket.administratorResponse&&t.jsxs(t.Fragment,{children:[t.jsx("h4",{className:e.info_title,children:"üí¨ –û—Ç–≤–µ—Ç—ã:"}),t.jsx("div",{className:e.responses,children:t.jsx(J,{children:n.ticket.administratorResponse})})]})]}),t.jsxs("div",{className:e.response_form,children:[t.jsx("h4",{className:e.info_title,children:"‚úçÔ∏è –í–∞—à –æ—Ç–≤–µ—Ç:"}),t.jsxs("div",{className:e.ai_suggestions_block,children:[t.jsx("button",{className:e.ai_suggestions_button,onClick:z,disabled:w,children:w?"‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...":"ü§ñ –ü–æ–¥–æ–±—Ä–∞—Ç—å AI-–∑–∞–≥–æ—Ç–æ–≤–∫–∏"}),S.length>0&&t.jsxs("div",{className:e.ai_suggestions_list,children:[t.jsx("p",{className:e.ai_suggestions_title,children:"–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞:"}),S.map((s,a)=>t.jsxs("div",{className:e.ai_suggestion_item,onClick:()=>G(s),children:[t.jsxs("span",{className:e.suggestion_number,children:[a+1,"."]}),t.jsx("p",{className:e.suggestion_text,children:s})]},a))]})]}),t.jsx("textarea",{className:e.response_textarea,value:f,onChange:s=>j(s.target.value),placeholder:"–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ AI-–∑–∞–≥–æ—Ç–æ–≤–∫—É...",rows:5}),t.jsx("div",{className:e.status_selector,children:t.jsxs("label",{className:e.status_label,children:["–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å:",t.jsxs("select",{className:e.status_select,value:T,onChange:s=>A(s.target.value),children:[t.jsx("option",{value:"Expectation",children:"üî¥ –û–∂–∏–¥–∞–Ω–∏–µ"}),t.jsx("option",{value:"InProgress",children:"üü° –í —Ä–∞–±–æ—Ç–µ"}),t.jsx("option",{value:"Completed",children:"üü¢ –ó–∞–≤–µ—Ä—à–µ–Ω–æ"})]})]})}),t.jsxs("div",{className:e.modal_actions,children:[t.jsx("button",{className:e.cancel_button,onClick:()=>m(!1),children:"–û—Ç–º–µ–Ω–∞"}),t.jsx("button",{className:e.submit_button,onClick:H,children:"–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç"})]})]})]})]})})]})};export{Kt as default};
